### 分布式架构

------

[TOC]

##### 01：从分布式到集中式

- 单点（大型机） 到 分布式（小型pc）；

###### 集中式特点

- 部结署构简单，底层性能卓越，不需要考虑多个节点之间的**分布式协作**问题。

###### 分布式特点

- 分布性
  - 机柜隔离，机房隔离，城市隔离；
- 对等性：
  - 分布式系中统的计算机没有主从之分，既没有控制整个系统的主机，也没有被控制的从机，组成分布系式统的所有计算机节点都对是等的。
  - **数据副本**：指在不同的节点上持久化同一份数据，当某一个节点上存储的数据丢失时，可以从副本上读取到该数据。
  - **服务副本**：指多个节点提供同样的服务，每个节点都有能能力接收来自外部的请求并进行相应的处理。
- 并发性
- 缺乏全局时钟
  - 一个典型的分布式系统是由一系列在空间上随意分布的多个进程组成的，具有明显的分布性，这些进程之间通过交换消息来进行相互通信。因此在分布式系统中，很难定义两个事件究竟谁先谁后，原因就是因为分布式系统缺乏一个全局局的时钟序列控制。
- 网络分区
  - 当网络由于发生异常情况，导致分布式系统中部分节点之间的网络延时不断增大，最终导致组成分布式系统的所有点中，只有部分节点之间间能够进行正常通信，而另一些节点则不能，我们将这个现象称为**网络分区，俗称的“脑裂”。**

##### 02：从ACID 到 CAP/BASE

- 原子性
- 一致性
- 隔离性
- 持久性

###### CAP 理论 【2000年提出】

- CAP：告诉我们一个分布式系统不可能同时满足一致性〈Consistency)、可用性(Availability)和分区容错性(Partition tolerance)这三个基本需求，最多只能同时满足其中的两项。
  - C：每个节点的数据具有一致性；
    - **放弃强一致性（弱一致性），最终一致性；**
  - A：指系统提供的服务必须处于一直可用的状态，对于用户的每一个操作请求总是能够在**有限的时间**内**返回结果**。
  - P：分布式系统在遇到任何网络分区故障时，仍然需要能够保证对外提供满足一致性和可用性的服务，除非是整个网络环境都发生了故障。
    - 组成一个分布式系统的**每个节点的加入与退出都可以看作是一个特殊的网络分区**。
- 对于分布系式统而言，网络问题是一个必定会出现的异常情况，因此分区容错性也就成为了一个分布式系统必然需要面对和解决的问题。因此系统架构设计师往往需要把精力花在**如何根据业务特点在C（一致性）和A（可用性）之间寻求平衡**。

###### BASE 理论

- BASE：是 BasicallyAvailable（基本可用）、Softstate（软状态）和 Eventually consistent（最终一致性）三个短语的简写。
  - BASE是对CAP中一致性和可用性**权衡的结果**，其来源于对大规模互联网系统分布式实践的总结，是基于CAP定理逐步演化而来的，其核心思想是**即使无法做到强一致性(Strong consistency)，但每个应用都可以根据自身的业务特点，采用适当的方式来使系统达到最终一致性(Eventual consistency)。**
- 基本可用：



