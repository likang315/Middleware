### 1：MySQL引擎 MyISAM，InnoDB有 什么区别 ？

**MyISAM** ：是MySQL`5.5.8`之前 的默认存储引擎

###### 	1：不支持事务，表锁设计，但是支持全文索引

###### 		2：只缓存索引文件，不缓存数据文件，数据文件的缓存交给操作系统完成

###### 		3：MyISAM存储引擎表存由 MYD 和 MYI ：MYD (MYData)：存放数据文件   和     MYI (MYIndex)：存放索引文件



**InnoDB** ：是 MySQL 5.5.8之后 的默认存储引擎

###### 	1：事务型存储引擎，支持回滚、崩溃恢复能力

###### 2：支持行锁，表锁设计，支持外键

###### 	3：通过MVCC（多版本并发控制）,来提高并发性，并且在Repeatable 隔离级别下，利用 next-key 解决幻读

###### 	3：表 和 索引在一个表空间中,表空间可以包含多个段，数据段，索引段，回滚段

###### 	4：提供 插入缓冲（Insert Buffer），二次写（Double write）， 自适应哈希索引，预读（read ahead） 提高性能



### 2：从性能上考虑，MySQL InnoDB 表主键如何选择，为什么  ?

若没有显示的定义主键，会选择从右往左，**第一个不为null的字段作为主键**，若没有，则存储引擎会为**每一行生成 6 个字节的RowID** ，并作为主键

主键不可能无限增长，有界限，分表分库

**自增主键**

InnoDB 使用聚集索引，数据记录本身被存于主索引 (一颗B+Tree) 的叶子节点上。这就要求同一个叶子节点内(大小为一个内存页或磁盘页)的 各条数据记录按主键顺序存放,因此每当有一条新的记录插入时,MySQL会根据其主键将其插入适当的节点和位置,如果页面达到装载因子(Inno DB默认为15/16)，则开辟一个新的页(节点)，如果表使用自增主键,那么每次**插入新的记录,记录就会顺序添加到当前索引节点的后续位置, 当一页写满,就会自动开辟一个新的页**。这样就会**形成一个紧凑的索引结构,近似顺序填满**，由于每次插入时也不需要移动已有数据,因此效率很高,也不会增加很多开销在维护索引上

如果使用非自增主键(如果身份证号或学号等),由于每次插入主键的值近似于随机,因此每次新纪录都要被插到现有索引页得中间某个位置,**此 时MySQL不得不为了将新记录插到合适位置而移动数据,甚至目标页面可能已经被回写到磁盘上而从缓存中清掉,**此时又要从磁盘上读回来,这增加了很多开销，**同时频繁的移动、分页操作造成了大量的碎片,得到了不够紧凑的索引结构,**后续不得不通过OPTIMIZE TABLE来重建表并优化填充页面







