### HttpClient

------

​	执行HTTP方法，只要用户提供一个request的对象，HttpClient就会将用户的请求发送到目标服务器上，并且返回一个respone对象，如果没有执行成功将抛出一个异常；

##### 1：导入jar包

```xml
<!-- https://mvnrepository.com/artifact/org.apache.httpcomponents/httpclient -->
<dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.5.6</version>
</dependency>
```

##### 2：GET、POST

```java
// 可以直接封装好URL
public static String sendGet(String url) {
		CloseableHttpClient httpclient = HttpClients.createDefault();
		HttpGet httpget = new HttpGet(url);
		HttpResponse response = null;
    int httpStatusCode = -1；
		try {
			/* 封装参数:key=value&key1=value1
      if (params != null && params.size() > 0) {
        final String str = EntityUtils.toString(
          new UrlEncodedFormEntity(params, HTTP.UTF_8));
        httpget.setURI(new URI(httpget.getURI().toString() + "?" + str));
      }*/

			response = httpclient.execute(httpget);
		} catch (IOException e1) {
			e1.printStackTrace();
		}
		String result = null;
		try {
      // 获取状态码
      final StatusLine sl = response.getStatusLine();
      if (sl != null) {
        httpStatusCode = sl.getStatusCode();
      }
      HttpEntity entity = response.getEntity();
			if (entity != null) {
				result = EntityUtils.toString(entity);
			}
		} catch (ParseException | IOException e) {
			e.printStackTrace();
		} finally {
        // 关闭请求附带的系统资源
				response.close();
		}
		return result;
	}

// post 请求参数key-value
public static String sendPost(String url, Map<String, String> map) {
		List<NameValuePair> params = new ArrayList<NameValuePair>();
		for (Map.Entry<String, String> entry : map.entrySet()) {
			formparams.add(new BasicNameValuePair(entry.getKey(), entry.getValue()));
		}
  	// 格式化后的请求参数
		UrlEncodedFormEntity entity = new UrlEncodedFormEntity(formparams, Consts.UTF_8);
		HttpPost httppost = new HttpPost(url);
		httppost.setEntity(entity);
		CloseableHttpResponse response = null;
  	String result = null；
		try {
			response = httpclient.execute(httppost);
      HttpEntity entity1 = response.getEntity();
      result = EntityUtils.toString(entity1);
		} catch (IOException e) {
			e.printStackTrace();
		} finally {
				response.close();
		}
		return result;
}

// 设置请求超时的方式，超时抛出异常
public String get(final String url, int timeout) {
  HttpGet httpGet = new HttpGet(url);
  RequestConfig config = RequestConfig.custom().setSocketTimeout(timeout).build();
  httpGet.setConfig(config);
  return get(httpGet);
}
```

##### 3：API

- ###### HttpResponse

  - 整个请求报文
  - HttpEntity`  `getEntity()
    - 获取请求报体
  - StatusLine`  `getStatusLine()
    - 获取状态码行信息

- ###### HttpGet

  - 创建GET请求，参数为URL

- ###### HttpPost

  - 创建POST请求，参数为URL

- ###### NameValuePair

  - 创建请求是的参数类

- ###### UrlEncodedFormEntity

  - 用于格式化请求参数，把请求格式化为该请求指定格式



