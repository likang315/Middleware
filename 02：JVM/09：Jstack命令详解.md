### Jstack

------

[TOC]

##### 01：概述

- 是JDK自带的一种**堆栈跟踪工具**。
- Jstack用于打印出给定的java进程ID或core file或远程调试服务的Java堆栈信息；
- Jstack 用于生成 java 虚拟机当前时刻的**线程快照**。线程快照是当前java虚拟机内每一条线程正在执行的方法堆栈的集合，生成线程快照的主要目的是**定位线程出现长时间停顿的原因**，如线程间死锁、死循环、请求外部资源导致的长时间等待等。

```
jstack [-l] pid
```

##### 02：一次负载过高定位过程

1. 查看GC 情况（频率，耗时）；
2. 查看占用CPU 最大的进程；
   - top
3. 查看占用CPU 最大的线程；
   - top -Hp pid 
4. 查看线程堆栈；
   - printf "%x\n" tid; 输出16精致
   - jstack pid | grep tid(16进制)

